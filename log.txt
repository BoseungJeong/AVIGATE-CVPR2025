2024-10-20 02:19:27,345:INFO: device: cuda:2 n_gpu: 4
2024-10-20 02:19:27,345:INFO: Effective parameters:
2024-10-20 02:19:27,346:INFO:   <<< alpha: 0.0
2024-10-20 02:19:27,346:INFO:   <<< audio_path: ../../datasets/MSRVTT/videos/audio_all_compressed
2024-10-20 02:19:27,346:INFO:   <<< audio_query_layers: 4
2024-10-20 02:19:27,346:INFO:   <<< batch_size: 128
2024-10-20 02:19:27,346:INFO:   <<< batch_size_val: 32
2024-10-20 02:19:27,346:INFO:   <<< beta: 0.2
2024-10-20 02:19:27,346:INFO:   <<< cache_dir: 
2024-10-20 02:19:27,346:INFO:   <<< coef_lr: 0.001
2024-10-20 02:19:27,346:INFO:   <<< cross_model: cross-base
2024-10-20 02:19:27,346:INFO: device: cuda:3 n_gpu: 4
2024-10-20 02:19:27,346:INFO:   <<< cross_num_hidden_layers: 4
2024-10-20 02:19:27,346:INFO:   <<< data_path: ../../datasets/MSRVTT/MSRVTT_data.json
2024-10-20 02:19:27,346:INFO: device: cuda:1 n_gpu: 4
2024-10-20 02:19:27,346:INFO:   <<< datatype: msrvtt
2024-10-20 02:19:27,346:INFO:   <<< do_eval: False
2024-10-20 02:19:27,346:INFO:   <<< do_lower_case: False
2024-10-20 02:19:27,346:INFO:   <<< do_pretrain: False
2024-10-20 02:19:27,346:INFO:   <<< do_train: True
2024-10-20 02:19:27,346:INFO:   <<< epochs: 5
2024-10-20 02:19:27,346:INFO:   <<< eval_frame_order: 0
2024-10-20 02:19:27,346:INFO:   <<< eval_max_frames: 12
2024-10-20 02:19:27,346:INFO:   <<< expand_msrvtt_sentences: True
2024-10-20 02:19:27,346:INFO:   <<< feature_framerate: 1
2024-10-20 02:19:27,346:INFO:   <<< features_path: ../../datasets/MSRVTT/videos/all_compressed
2024-10-20 02:19:27,346:INFO:   <<< fp16: False
2024-10-20 02:19:27,346:INFO:   <<< fp16_opt_level: O1
2024-10-20 02:19:27,346:INFO:   <<< freeze_layer_num: 12
2024-10-20 02:19:27,346:INFO:   <<< gradient_accumulation_steps: 1
2024-10-20 02:19:27,346:INFO:   <<< hard_negative_rate: 0.5
2024-10-20 02:19:27,346:INFO:   <<< init_model: None
2024-10-20 02:19:27,346:INFO:   <<< linear_patch: 2d
2024-10-20 02:19:27,346:INFO:   <<< local_rank: 0
2024-10-20 02:19:27,346:INFO:   <<< loose_type: True
2024-10-20 02:19:27,346:INFO:   <<< lr: 0.0001
2024-10-20 02:19:27,346:INFO:   <<< lr_decay: 0.9
2024-10-20 02:19:27,346:INFO:   <<< margin: 0.1
2024-10-20 02:19:27,346:INFO:   <<< margin_BD: 0.1
2024-10-20 02:19:27,347:INFO:   <<< max_frames: 12
2024-10-20 02:19:27,347:INFO:   <<< max_words: 32
2024-10-20 02:19:27,347:INFO:   <<< n_display: 50
2024-10-20 02:19:27,347:INFO:   <<< n_gpu: 1
2024-10-20 02:19:27,347:INFO:   <<< n_pair: 1
2024-10-20 02:19:27,347:INFO:   <<< negative_weighting: 1
2024-10-20 02:19:27,347:INFO:   <<< num_thread_reader: 8
2024-10-20 02:19:27,347:INFO:   <<< output_dir: ckpts/ckpt_msrvtt_AQ_4_Transf_4_12tokens_BiMaxThsMarginAll0.1_Beta0.2
2024-10-20 02:19:27,347:INFO:   <<< pretrained_clip_name: ViT-B/32
2024-10-20 02:19:27,347:INFO:   <<< rank: 0
2024-10-20 02:19:27,347:INFO:   <<< resume_model: None
2024-10-20 02:19:27,347:INFO:   <<< sampled_use_mil: False
2024-10-20 02:19:27,347:INFO:   <<< seed: 42
2024-10-20 02:19:27,347:INFO:   <<< sim_header: seqTransf
2024-10-20 02:19:27,347:INFO:   <<< slice_framepos: 2
2024-10-20 02:19:27,347:INFO:   <<< task_type: retrieval
2024-10-20 02:19:27,347:INFO:   <<< temperature: 1.0
2024-10-20 02:19:27,347:INFO:   <<< text_num_hidden_layers: 12
2024-10-20 02:19:27,347:INFO:   <<< train_csv: ../../datasets/MSRVTT/MSRVTT_train.9k.csv
2024-10-20 02:19:27,347:INFO:   <<< train_frame_order: 0
2024-10-20 02:19:27,347:INFO:   <<< use_mil: False
2024-10-20 02:19:27,347:INFO:   <<< val_csv: ../../datasets/MSRVTT/MSRVTT_JSFUSION_test.csv
2024-10-20 02:19:27,347:INFO:   <<< video_dim: 1024
2024-10-20 02:19:27,347:INFO:   <<< visual_num_hidden_layers: 12
2024-10-20 02:19:27,347:INFO:   <<< warmup_proportion: 0.1
2024-10-20 02:19:27,347:INFO:   <<< world_size: 4
2024-10-20 02:19:27,347:INFO: device: cuda:0 n_gpu: 4
2024-10-20 02:19:33,525:INFO: loading archive file /home/boseung01/research/CLIP4Clip/modules/cross-base
2024-10-20 02:19:33,553:INFO: Model config {
  "attention_probs_dropout_prob": 0.1,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 512,
  "initializer_range": 0.02,
  "intermediate_size": 2048,
  "max_position_embeddings": 128,
  "num_attention_heads": 8,
  "num_hidden_layers": 4,
  "type_vocab_size": 2,
  "vocab_size": 512
}

2024-10-20 02:19:33,553:INFO: Weight doesn't exsits. /home/boseung01/research/CLIP4Clip/modules/cross-base/cross_pytorch_model.bin
2024-10-20 02:19:33,553:WARNING: Stage-One:True, Stage-Two:False
2024-10-20 02:19:33,553:WARNING: Test retrieval by loose type.
2024-10-20 02:19:33,553:WARNING: 	 embed_dim: 512
2024-10-20 02:19:33,553:WARNING: 	 image_resolution: 224
2024-10-20 02:19:33,554:WARNING: 	 vision_layers: 12
2024-10-20 02:19:33,554:WARNING: 	 vision_width: 768
2024-10-20 02:19:33,554:WARNING: 	 vision_patch_size: 32
2024-10-20 02:19:33,554:WARNING: 	 context_length: 77
2024-10-20 02:19:33,554:WARNING: 	 vocab_size: 49408
2024-10-20 02:19:33,554:WARNING: 	 transformer_width: 512
2024-10-20 02:19:33,554:WARNING: 	 transformer_heads: 8
2024-10-20 02:19:33,554:WARNING: 	 transformer_layers: 12
2024-10-20 02:19:33,554:WARNING: 		 linear_patch: 2d
2024-10-20 02:19:33,554:WARNING: 	 cut_top_layer: 0
2024-10-20 02:19:54,898:WARNING: 	 sim_header: seqTransf
2024-10-20 02:20:12,427:INFO: number of params (M): 168.11
2024-10-20 02:20:12,942:INFO: number of params (M): 168.11
2024-10-20 02:20:13,783:INFO: --------------------
2024-10-20 02:20:13,953:INFO: number of params (M): 168.11
2024-10-20 02:20:13,960:INFO: ***** Running test *****
2024-10-20 02:20:13,960:INFO:   Num examples = 1000
2024-10-20 02:20:13,960:INFO:   Batch size = 32
2024-10-20 02:20:13,960:INFO:   Num steps = 32
2024-10-20 02:20:13,960:INFO: ***** Running val *****
2024-10-20 02:20:13,960:INFO:   Num examples = 1000
2024-10-20 02:20:14,026:INFO: number of params (M): 168.11
2024-10-20 02:20:21,915:INFO: ***** Running training *****
2024-10-20 02:20:21,916:INFO:   Num examples = 180000
2024-10-20 02:20:21,916:INFO:   Batch size = 128
2024-10-20 02:20:21,916:INFO:   Num total steps = 7030
2024-10-20 02:23:40,045:INFO: Epoch: 1/5, Step: 50/1406, Lr: 0.000000007-0.000007112-0.000711238, Loss: 7.383170, Time/step: 3.961524, DTime/step: 2.943026
2024-10-20 02:26:27,025:INFO: Epoch: 1/5, Step: 100/1406, Lr: 0.000000014-0.000014225-0.001422475, Loss: 7.688540, Time/step: 3.339580, DTime/step: 2.946202
2024-10-20 02:29:30,970:INFO: Epoch: 1/5, Step: 150/1406, Lr: 0.000000021-0.000021337-0.002133713, Loss: 6.670822, Time/step: 3.678875, DTime/step: 3.272146
2024-10-20 02:32:46,246:INFO: Epoch: 1/5, Step: 200/1406, Lr: 0.000000028-0.000028450-0.002844950, Loss: 7.007708, Time/step: 3.905522, DTime/step: 3.503300
2024-10-20 02:35:38,406:INFO: Epoch: 1/5, Step: 250/1406, Lr: 0.000000036-0.000035562-0.003556188, Loss: 6.868796, Time/step: 3.443184, DTime/step: 3.057399
2024-10-20 02:38:38,927:INFO: Epoch: 1/5, Step: 300/1406, Lr: 0.000000043-0.000042674-0.004267425, Loss: 6.681237, Time/step: 3.610394, DTime/step: 3.217190
2024-10-20 02:41:31,257:INFO: Epoch: 1/5, Step: 350/1406, Lr: 0.000000050-0.000049787-0.004978663, Loss: 7.068979, Time/step: 3.446570, DTime/step: 3.050746
2024-10-20 02:44:35,111:INFO: Epoch: 1/5, Step: 400/1406, Lr: 0.000000057-0.000056899-0.005689900, Loss: 6.521769, Time/step: 3.677038, DTime/step: 3.270311
2024-10-20 02:47:31,665:INFO: Epoch: 1/5, Step: 450/1406, Lr: 0.000000064-0.000064011-0.006401138, Loss: 5.901090, Time/step: 3.531049, DTime/step: 2.927125
2024-10-20 02:50:37,570:INFO: Epoch: 1/5, Step: 500/1406, Lr: 0.000000071-0.000071124-0.007112376, Loss: 6.500118, Time/step: 3.718105, DTime/step: 3.326946
2024-10-20 02:53:33,835:INFO: Epoch: 1/5, Step: 550/1406, Lr: 0.000000078-0.000078236-0.007823613, Loss: 5.590849, Time/step: 3.525276, DTime/step: 3.124285
2024-10-20 02:56:28,287:INFO: Epoch: 1/5, Step: 600/1406, Lr: 0.000000085-0.000085349-0.008534851, Loss: 6.246982, Time/step: 3.489009, DTime/step: 2.954598
2024-10-20 02:59:27,891:INFO: Epoch: 1/5, Step: 650/1406, Lr: 0.000000092-0.000092461-0.009246088, Loss: 5.909430, Time/step: 3.592019, DTime/step: 2.216364
2024-10-20 03:02:28,595:INFO: Epoch: 1/5, Step: 700/1406, Lr: 0.000000100-0.000099573-0.009957326, Loss: 6.081323, Time/step: 3.614074, DTime/step: 1.927040
2024-10-20 03:05:19,199:INFO: Epoch: 1/5, Step: 750/1406, Lr: 0.000000097-0.000097218-0.009721784, Loss: 5.262074, Time/step: 3.412060, DTime/step: 1.950672
2024-10-20 03:08:22,100:INFO: Epoch: 1/5, Step: 800/1406, Lr: 0.000000097-0.000096839-0.009683861, Loss: 5.391848, Time/step: 3.657978, DTime/step: 1.908834
2024-10-20 03:11:16,375:INFO: Epoch: 1/5, Step: 850/1406, Lr: 0.000000096-0.000096436-0.009643599, Loss: 5.024431, Time/step: 3.485488, DTime/step: 2.207044
2024-10-20 03:14:32,213:INFO: Epoch: 1/5, Step: 900/1406, Lr: 0.000000096-0.000096010-0.009601019, Loss: 6.082998, Time/step: 3.916568, DTime/step: 3.379048
2024-10-20 03:17:27,023:INFO: Epoch: 1/5, Step: 950/1406, Lr: 0.000000096-0.000095561-0.009556142, Loss: 5.763924, Time/step: 3.496174, DTime/step: 3.107419
2024-10-20 03:20:28,524:INFO: Epoch: 1/5, Step: 1000/1406, Lr: 0.000000095-0.000095090-0.009508991, Loss: 6.373138, Time/step: 3.629891, DTime/step: 3.237186
2024-10-20 03:23:25,492:INFO: Epoch: 1/5, Step: 1050/1406, Lr: 0.000000095-0.000094596-0.009459588, Loss: 5.607054, Time/step: 3.539328, DTime/step: 3.150842
2024-10-20 03:26:36,935:INFO: Epoch: 1/5, Step: 1100/1406, Lr: 0.000000094-0.000094080-0.009407959, Loss: 4.440615, Time/step: 3.828117, DTime/step: 3.449930
2024-10-20 03:29:36,059:INFO: Epoch: 1/5, Step: 1150/1406, Lr: 0.000000094-0.000093541-0.009354130, Loss: 5.445112, Time/step: 3.581968, DTime/step: 3.205084
2024-10-20 03:32:40,267:INFO: Epoch: 1/5, Step: 1200/1406, Lr: 0.000000093-0.000092981-0.009298127, Loss: 5.428636, Time/step: 3.684031, DTime/step: 3.291049
2024-10-20 03:35:39,859:INFO: Epoch: 1/5, Step: 1250/1406, Lr: 0.000000092-0.000092400-0.009239977, Loss: 5.660057, Time/step: 3.591567, DTime/step: 3.218545
2024-10-20 03:38:49,489:INFO: Epoch: 1/5, Step: 1300/1406, Lr: 0.000000092-0.000091797-0.009179711, Loss: 4.985112, Time/step: 3.790718, DTime/step: 3.401876
2024-10-20 03:41:53,543:INFO: Epoch: 1/5, Step: 1350/1406, Lr: 0.000000091-0.000091174-0.009117359, Loss: 4.664978, Time/step: 3.680941, DTime/step: 3.289744
2024-10-20 03:44:41,004:INFO: Epoch: 1/5, Step: 1400/1406, Lr: 0.000000091-0.000090530-0.009052951, Loss: 4.014061, Time/step: 3.349035, DTime/step: 2.956617
2024-10-20 03:44:49,147:INFO: Epoch 1/5 Finished, Train Loss: 6.032462
2024-10-20 03:44:54,946:INFO: Model saved to ckpts/ckpt_msrvtt_AQ_4_Transf_4_12tokens_BiMaxThsMarginAll0.1_Beta0.2/pytorch_model.bin.0
2024-10-20 03:44:54,947:INFO: Optimizer saved to ckpts/ckpt_msrvtt_AQ_4_Transf_4_12tokens_BiMaxThsMarginAll0.1_Beta0.2/pytorch_opt.bin.0
2024-10-20 03:44:54,947:INFO: Eval on val dataset
2024-10-20 03:47:01,416:INFO: sim matrix size: 1000, 1000
2024-10-20 03:47:01,508:INFO: 	 Length-T: 1000, Length-V:1000
2024-10-20 03:47:01,508:INFO: Text-to-Video:
2024-10-20 03:47:01,508:INFO: 	>>>  R@1: 45.8 - R@5: 73.2 - R@10: 81.8 - Median R: 2.0 - Mean R: 13.7
2024-10-20 03:47:01,508:INFO: Video-to-Text:
2024-10-20 03:47:01,508:INFO: 	>>>  V2T$R@1: 46.8 - V2T$R@5: 73.7 - V2T$R@10: 83.0 - V2T$Median R: 2.0 - V2T$Mean R: 9.7
2024-10-20 03:47:01,509:INFO: The best model is: ckpts/ckpt_msrvtt_AQ_4_Transf_4_12tokens_BiMaxThsMarginAll0.1_Beta0.2/pytorch_model.bin.0, the R1 is: 45.8000
2024-10-20 03:49:46,437:INFO: Epoch: 2/5, Step: 44/1406, Lr: 0.000000090-0.000089865-0.008986519, Loss: 4.606432, Time/step: 3.294815, DTime/step: 1.561099
2024-10-20 03:52:29,347:INFO: Epoch: 2/5, Step: 94/1406, Lr: 0.000000089-0.000089181-0.008918097, Loss: 5.696238, Time/step: 3.258176, DTime/step: 1.843018
2024-10-20 03:55:21,742:INFO: Epoch: 2/5, Step: 144/1406, Lr: 0.000000088-0.000088477-0.008847719, Loss: 4.522316, Time/step: 3.447887, DTime/step: 1.859004
2024-10-20 03:58:33,193:INFO: Epoch: 2/5, Step: 194/1406, Lr: 0.000000088-0.000087754-0.008775420, Loss: 4.362340, Time/step: 3.828997, DTime/step: 2.720127
2024-10-20 04:01:30,048:INFO: Epoch: 2/5, Step: 244/1406, Lr: 0.000000087-0.000087012-0.008701237, Loss: 3.702459, Time/step: 3.537086, DTime/step: 2.946136
2024-10-20 04:04:26,136:INFO: Epoch: 2/5, Step: 294/1406, Lr: 0.000000086-0.000086252-0.008625205, Loss: 4.566497, Time/step: 3.521745, DTime/step: 3.004045
2024-10-20 04:07:16,122:INFO: Epoch: 2/5, Step: 344/1406, Lr: 0.000000085-0.000085474-0.008547364, Loss: 5.629666, Time/step: 3.399689, DTime/step: 2.993519
2024-10-20 04:10:24,418:INFO: Epoch: 2/5, Step: 394/1406, Lr: 0.000000085-0.000084678-0.008467751, Loss: 4.903564, Time/step: 3.765900, DTime/step: 3.249829
2024-10-20 04:13:22,513:INFO: Epoch: 2/5, Step: 444/1406, Lr: 0.000000084-0.000083864-0.008386408, Loss: 4.527659, Time/step: 3.561843, DTime/step: 3.174974
2024-10-20 04:16:19,694:INFO: Epoch: 2/5, Step: 494/1406, Lr: 0.000000083-0.000083034-0.008303374, Loss: 4.956911, Time/step: 3.543586, DTime/step: 3.152907
2024-10-20 04:19:14,818:INFO: Epoch: 2/5, Step: 544/1406, Lr: 0.000000082-0.000082187-0.008218690, Loss: 3.730472, Time/step: 3.502428, DTime/step: 3.112436
2024-10-20 04:22:21,542:INFO: Epoch: 2/5, Step: 594/1406, Lr: 0.000000081-0.000081324-0.008132400, Loss: 4.974048, Time/step: 3.734341, DTime/step: 3.340373
2024-10-20 04:25:21,858:INFO: Epoch: 2/5, Step: 644/1406, Lr: 0.000000080-0.000080445-0.008044546, Loss: 4.634109, Time/step: 3.606205, DTime/step: 3.215382
2024-10-20 04:28:16,398:INFO: Epoch: 2/5, Step: 694/1406, Lr: 0.000000080-0.000079552-0.007955172, Loss: 5.151555, Time/step: 3.490777, DTime/step: 3.111583
2024-10-20 04:31:07,811:INFO: Epoch: 2/5, Step: 744/1406, Lr: 0.000000079-0.000078643-0.007864322, Loss: 4.709958, Time/step: 3.428220, DTime/step: 3.018083
2024-10-20 04:34:18,619:INFO: Epoch: 2/5, Step: 794/1406, Lr: 0.000000078-0.000077720-0.007772043, Loss: 4.292674, Time/step: 3.816114, DTime/step: 3.421637
2024-10-20 04:37:12,627:INFO: Epoch: 2/5, Step: 844/1406, Lr: 0.000000077-0.000076784-0.007678379, Loss: 4.497173, Time/step: 3.480154, DTime/step: 3.079386
2024-10-20 04:40:08,626:INFO: Epoch: 2/5, Step: 894/1406, Lr: 0.000000076-0.000075834-0.007583379, Loss: 3.959569, Time/step: 3.519968, DTime/step: 3.107126
2024-10-20 04:43:07,242:INFO: Epoch: 2/5, Step: 944/1406, Lr: 0.000000075-0.000074871-0.007487089, Loss: 5.204463, Time/step: 3.572315, DTime/step: 3.180734
2024-10-20 04:46:07,797:INFO: Epoch: 2/5, Step: 994/1406, Lr: 0.000000074-0.000073896-0.007389557, Loss: 4.459568, Time/step: 3.611079, DTime/step: 3.211242
2024-10-20 04:49:02,049:INFO: Epoch: 2/5, Step: 1044/1406, Lr: 0.000000073-0.000072908-0.007290832, Loss: 4.474314, Time/step: 3.485010, DTime/step: 3.097168
2024-10-20 04:51:55,751:INFO: Epoch: 2/5, Step: 1094/1406, Lr: 0.000000072-0.000071910-0.007190963, Loss: 4.343560, Time/step: 3.474011, DTime/step: 3.087230
2024-10-20 04:54:54,117:INFO: Epoch: 2/5, Step: 1144/1406, Lr: 0.000000071-0.000070900-0.007090001, Loss: 4.443571, Time/step: 3.567310, DTime/step: 2.751304
2024-10-20 04:57:55,114:INFO: Epoch: 2/5, Step: 1194/1406, Lr: 0.000000070-0.000069880-0.006987995, Loss: 5.539980, Time/step: 3.619850, DTime/step: 3.214667
2024-10-20 05:00:47,021:INFO: Epoch: 2/5, Step: 1244/1406, Lr: 0.000000069-0.000068850-0.006884997, Loss: 4.083555, Time/step: 3.438133, DTime/step: 3.046884
2024-10-20 05:03:48,171:INFO: Epoch: 2/5, Step: 1294/1406, Lr: 0.000000068-0.000067811-0.006781057, Loss: 5.013214, Time/step: 3.622887, DTime/step: 3.211998
2024-10-20 05:06:43,480:INFO: Epoch: 2/5, Step: 1344/1406, Lr: 0.000000067-0.000066762-0.006676229, Loss: 4.655229, Time/step: 3.506152, DTime/step: 3.109422
2024-10-20 05:09:44,948:INFO: Epoch: 2/5, Step: 1394/1406, Lr: 0.000000066-0.000065706-0.006570563, Loss: 4.166925, Time/step: 3.629342, DTime/step: 3.233393
2024-10-20 05:10:04,331:INFO: Epoch 2/5 Finished, Train Loss: 4.472557
2024-10-20 05:10:08,470:INFO: Model saved to ckpts/ckpt_msrvtt_AQ_4_Transf_4_12tokens_BiMaxThsMarginAll0.1_Beta0.2/pytorch_model.bin.1
2024-10-20 05:10:08,471:INFO: Optimizer saved to ckpts/ckpt_msrvtt_AQ_4_Transf_4_12tokens_BiMaxThsMarginAll0.1_Beta0.2/pytorch_opt.bin.1
2024-10-20 05:10:08,471:INFO: Eval on val dataset
2024-10-20 05:12:01,692:INFO: sim matrix size: 1000, 1000
2024-10-20 05:12:01,785:INFO: 	 Length-T: 1000, Length-V:1000
2024-10-20 05:12:01,785:INFO: Text-to-Video:
2024-10-20 05:12:01,785:INFO: 	>>>  R@1: 47.4 - R@5: 73.2 - R@10: 83.6 - Median R: 2.0 - Mean R: 13.2
2024-10-20 05:12:01,785:INFO: Video-to-Text:
2024-10-20 05:12:01,785:INFO: 	>>>  V2T$R@1: 47.7 - V2T$R@5: 74.9 - V2T$R@10: 83.8 - V2T$Median R: 2.0 - V2T$Mean R: 9.5
2024-10-20 05:12:01,786:INFO: The best model is: ckpts/ckpt_msrvtt_AQ_4_Transf_4_12tokens_BiMaxThsMarginAll0.1_Beta0.2/pytorch_model.bin.1, the R1 is: 47.4000
2024-10-20 05:14:19,822:INFO: Epoch: 3/5, Step: 38/1406, Lr: 0.000000065-0.000064641-0.006464114, Loss: 3.517621, Time/step: 2.757085, DTime/step: 1.297816
2024-10-20 05:17:11,590:INFO: Epoch: 3/5, Step: 88/1406, Lr: 0.000000064-0.000063569-0.006356933, Loss: 3.723353, Time/step: 3.435313, DTime/step: 1.824180
2024-10-20 05:20:04,534:INFO: Epoch: 3/5, Step: 138/1406, Lr: 0.000000062-0.000062491-0.006249076, Loss: 3.524153, Time/step: 3.458876, DTime/step: 1.818963
2024-10-20 05:23:01,887:INFO: Epoch: 3/5, Step: 188/1406, Lr: 0.000000061-0.000061406-0.006140594, Loss: 3.223490, Time/step: 3.546958, DTime/step: 1.862245
2024-10-20 05:25:58,732:INFO: Epoch: 3/5, Step: 238/1406, Lr: 0.000000060-0.000060315-0.006031543, Loss: 4.100981, Time/step: 3.536865, DTime/step: 1.913835
2024-10-20 05:28:49,205:INFO: Epoch: 3/5, Step: 288/1406, Lr: 0.000000059-0.000059220-0.005921977, Loss: 3.876383, Time/step: 3.409445, DTime/step: 1.817991
2024-10-20 05:31:52,644:INFO: Epoch: 3/5, Step: 338/1406, Lr: 0.000000058-0.000058120-0.005811951, Loss: 2.662426, Time/step: 3.668774, DTime/step: 2.112060
2024-10-20 05:34:57,322:INFO: Epoch: 3/5, Step: 388/1406, Lr: 0.000000057-0.000057015-0.005701520, Loss: 3.018148, Time/step: 3.693423, DTime/step: 2.042937
2024-10-20 05:37:45,373:INFO: Epoch: 3/5, Step: 438/1406, Lr: 0.000000056-0.000055907-0.005590738, Loss: 4.414852, Time/step: 3.360999, DTime/step: 2.256550
2024-10-20 05:40:42,847:INFO: Epoch: 3/5, Step: 488/1406, Lr: 0.000000055-0.000054797-0.005479661, Loss: 2.956033, Time/step: 3.549375, DTime/step: 2.391296
2024-10-20 05:43:39,032:INFO: Epoch: 3/5, Step: 538/1406, Lr: 0.000000054-0.000053683-0.005368345, Loss: 3.396529, Time/step: 3.523470, DTime/step: 2.953561
2024-10-20 05:46:48,558:INFO: Epoch: 3/5, Step: 588/1406, Lr: 0.000000053-0.000052568-0.005256845, Loss: 3.604870, Time/step: 3.790516, DTime/step: 3.349586
2024-10-20 05:49:51,328:INFO: Epoch: 3/5, Step: 638/1406, Lr: 0.000000051-0.000051452-0.005145217, Loss: 3.603281, Time/step: 3.655363, DTime/step: 3.270933
2024-10-20 05:52:45,915:INFO: Epoch: 3/5, Step: 688/1406, Lr: 0.000000050-0.000050335-0.005033516, Loss: 4.423103, Time/step: 3.491744, DTime/step: 3.103627
2024-10-20 05:55:43,976:INFO: Epoch: 3/5, Step: 738/1406, Lr: 0.000000049-0.000049218-0.004921799, Loss: 3.342560, Time/step: 3.561199, DTime/step: 3.174274
2024-10-20 05:58:52,361:INFO: Epoch: 3/5, Step: 788/1406, Lr: 0.000000048-0.000048101-0.004810120, Loss: 4.111234, Time/step: 3.767688, DTime/step: 3.377754
2024-10-20 06:01:53,807:INFO: Epoch: 3/5, Step: 838/1406, Lr: 0.000000047-0.000046985-0.004698536, Loss: 3.672758, Time/step: 3.628900, DTime/step: 3.235709
2024-10-20 06:04:52,765:INFO: Epoch: 3/5, Step: 888/1406, Lr: 0.000000046-0.000045871-0.004587103, Loss: 2.927884, Time/step: 3.579124, DTime/step: 3.190859
2024-10-20 06:07:41,870:INFO: Epoch: 3/5, Step: 938/1406, Lr: 0.000000045-0.000044759-0.004475876, Loss: 4.337362, Time/step: 3.382077, DTime/step: 2.973107
2024-10-20 06:10:45,307:INFO: Epoch: 3/5, Step: 988/1406, Lr: 0.000000044-0.000043649-0.004364911, Loss: 3.130476, Time/step: 3.668725, DTime/step: 3.212444
2024-10-20 06:13:44,985:INFO: Epoch: 3/5, Step: 1038/1406, Lr: 0.000000043-0.000042543-0.004254263, Loss: 3.534334, Time/step: 3.593440, DTime/step: 3.199370
2024-10-20 06:16:46,084:INFO: Epoch: 3/5, Step: 1088/1406, Lr: 0.000000041-0.000041440-0.004143987, Loss: 3.401659, Time/step: 3.621902, DTime/step: 3.231671
2024-10-20 06:19:40,471:INFO: Epoch: 3/5, Step: 1138/1406, Lr: 0.000000040-0.000040341-0.004034138, Loss: 3.105860, Time/step: 3.487697, DTime/step: 3.090489
2024-10-20 06:22:46,423:INFO: Epoch: 3/5, Step: 1188/1406, Lr: 0.000000039-0.000039248-0.003924772, Loss: 3.739350, Time/step: 3.719033, DTime/step: 3.313276
2024-10-20 06:25:34,734:INFO: Epoch: 3/5, Step: 1238/1406, Lr: 0.000000038-0.000038159-0.003815942, Loss: 3.341558, Time/step: 3.366209, DTime/step: 2.965827
2024-10-20 06:28:26,265:INFO: Epoch: 3/5, Step: 1288/1406, Lr: 0.000000037-0.000037077-0.003707703, Loss: 3.195235, Time/step: 3.430611, DTime/step: 3.044836
2024-10-20 06:31:14,980:INFO: Epoch: 3/5, Step: 1338/1406, Lr: 0.000000036-0.000036001-0.003600110, Loss: 3.809504, Time/step: 3.374270, DTime/step: 2.946534
2024-10-20 06:34:33,307:INFO: Epoch: 3/5, Step: 1388/1406, Lr: 0.000000035-0.000034932-0.003493216, Loss: 2.621547, Time/step: 3.966539, DTime/step: 3.574494
2024-10-20 06:35:04,474:INFO: Epoch 3/5 Finished, Train Loss: 3.603832
2024-10-20 06:35:08,616:INFO: Model saved to ckpts/ckpt_msrvtt_AQ_4_Transf_4_12tokens_BiMaxThsMarginAll0.1_Beta0.2/pytorch_model.bin.2
2024-10-20 06:35:08,617:INFO: Optimizer saved to ckpts/ckpt_msrvtt_AQ_4_Transf_4_12tokens_BiMaxThsMarginAll0.1_Beta0.2/pytorch_opt.bin.2
2024-10-20 06:35:08,617:INFO: Eval on val dataset
2024-10-20 06:37:03,483:INFO: sim matrix size: 1000, 1000
2024-10-20 06:37:03,576:INFO: 	 Length-T: 1000, Length-V:1000
2024-10-20 06:37:03,576:INFO: Text-to-Video:
2024-10-20 06:37:03,576:INFO: 	>>>  R@1: 49.1 - R@5: 74.2 - R@10: 84.3 - Median R: 2.0 - Mean R: 14.3
2024-10-20 06:37:03,576:INFO: Video-to-Text:
2024-10-20 06:37:03,576:INFO: 	>>>  V2T$R@1: 48.4 - V2T$R@5: 75.8 - V2T$R@10: 84.3 - V2T$Median R: 2.0 - V2T$Mean R: 9.5
2024-10-20 06:37:03,577:INFO: The best model is: ckpts/ckpt_msrvtt_AQ_4_Transf_4_12tokens_BiMaxThsMarginAll0.1_Beta0.2/pytorch_model.bin.2, the R1 is: 49.1000
2024-10-20 06:38:56,402:INFO: Epoch: 4/5, Step: 32/1406, Lr: 0.000000034-0.000033871-0.003387073, Loss: 3.263440, Time/step: 2.252692, DTime/step: 1.106151
2024-10-20 06:41:52,537:INFO: Epoch: 4/5, Step: 82/1406, Lr: 0.000000033-0.000032817-0.003281736, Loss: 3.307014, Time/step: 3.522667, DTime/step: 1.917085
2024-10-20 06:44:51,276:INFO: Epoch: 4/5, Step: 132/1406, Lr: 0.000000032-0.000031773-0.003177257, Loss: 2.887729, Time/step: 3.574765, DTime/step: 2.601166
2024-10-20 06:47:43,535:INFO: Epoch: 4/5, Step: 182/1406, Lr: 0.000000031-0.000030737-0.003073688, Loss: 3.177498, Time/step: 3.445106, DTime/step: 2.344110
2024-10-20 06:50:40,906:INFO: Epoch: 4/5, Step: 232/1406, Lr: 0.000000030-0.000029711-0.002971081, Loss: 3.375899, Time/step: 3.547404, DTime/step: 2.081218
2024-10-20 06:53:34,948:INFO: Epoch: 4/5, Step: 282/1406, Lr: 0.000000029-0.000028695-0.002869486, Loss: 2.846612, Time/step: 3.480709, DTime/step: 1.893545
2024-10-20 06:56:33,937:INFO: Epoch: 4/5, Step: 332/1406, Lr: 0.000000028-0.000027690-0.002768955, Loss: 2.698773, Time/step: 3.579704, DTime/step: 1.886852
2024-10-20 06:59:33,473:INFO: Epoch: 4/5, Step: 382/1406, Lr: 0.000000027-0.000026695-0.002669538, Loss: 3.869655, Time/step: 3.590604, DTime/step: 1.831997
2024-10-20 07:02:33,589:INFO: Epoch: 4/5, Step: 432/1406, Lr: 0.000000026-0.000025713-0.002571285, Loss: 2.523310, Time/step: 3.602314, DTime/step: 1.828582
2024-10-20 07:05:34,978:INFO: Epoch: 4/5, Step: 482/1406, Lr: 0.000000025-0.000024742-0.002474244, Loss: 2.927847, Time/step: 3.627779, DTime/step: 1.830345
2024-10-20 07:08:30,744:INFO: Epoch: 4/5, Step: 532/1406, Lr: 0.000000024-0.000023785-0.002378464, Loss: 3.044007, Time/step: 3.515299, DTime/step: 1.831949
2024-10-20 07:11:43,385:INFO: Epoch: 4/5, Step: 582/1406, Lr: 0.000000023-0.000022840-0.002283992, Loss: 2.978723, Time/step: 3.852798, DTime/step: 1.850786
2024-10-20 07:14:34,040:INFO: Epoch: 4/5, Step: 632/1406, Lr: 0.000000022-0.000021909-0.002190877, Loss: 3.184850, Time/step: 3.413088, DTime/step: 2.196186
2024-10-20 07:17:33,368:INFO: Epoch: 4/5, Step: 682/1406, Lr: 0.000000021-0.000020992-0.002099164, Loss: 3.354227, Time/step: 3.586546, DTime/step: 3.040007
2024-10-20 07:20:31,662:INFO: Epoch: 4/5, Step: 732/1406, Lr: 0.000000020-0.000020089-0.002008899, Loss: 3.272693, Time/step: 3.565867, DTime/step: 3.140733
2024-10-20 07:23:36,305:INFO: Epoch: 4/5, Step: 782/1406, Lr: 0.000000019-0.000019201-0.001920128, Loss: 3.480552, Time/step: 3.692842, DTime/step: 3.125915
2024-10-20 07:26:29,911:INFO: Epoch: 4/5, Step: 832/1406, Lr: 0.000000018-0.000018329-0.001832894, Loss: 2.862324, Time/step: 3.472111, DTime/step: 2.533684
2024-10-20 07:29:32,164:INFO: Epoch: 4/5, Step: 882/1406, Lr: 0.000000017-0.000017472-0.001747241, Loss: 3.654506, Time/step: 3.645037, DTime/step: 1.974072
2024-10-20 07:32:32,654:INFO: Epoch: 4/5, Step: 932/1406, Lr: 0.000000017-0.000016632-0.001663212, Loss: 2.820818, Time/step: 3.609807, DTime/step: 1.841973
2024-10-20 07:35:26,623:INFO: Epoch: 4/5, Step: 982/1406, Lr: 0.000000016-0.000015808-0.001580850, Loss: 3.758169, Time/step: 3.479359, DTime/step: 2.146199
2024-10-20 07:38:26,645:INFO: Epoch: 4/5, Step: 1032/1406, Lr: 0.000000015-0.000015002-0.001500194, Loss: 4.190265, Time/step: 3.600074, DTime/step: 2.409067
2024-10-20 07:41:22,422:INFO: Epoch: 4/5, Step: 1082/1406, Lr: 0.000000014-0.000014213-0.001421285, Loss: 3.377351, Time/step: 3.515516, DTime/step: 3.122209
2024-10-20 07:44:02,863:INFO: Epoch: 4/5, Step: 1132/1406, Lr: 0.000000013-0.000013442-0.001344163, Loss: 3.377418, Time/step: 3.208795, DTime/step: 2.713887
2024-10-20 07:47:05,496:INFO: Epoch: 4/5, Step: 1182/1406, Lr: 0.000000013-0.000012689-0.001268866, Loss: 2.956852, Time/step: 3.652627, DTime/step: 2.553991
2024-10-20 07:49:58,417:INFO: Epoch: 4/5, Step: 1232/1406, Lr: 0.000000012-0.000011954-0.001195432, Loss: 2.261551, Time/step: 3.458381, DTime/step: 2.534990
2024-10-20 07:53:10,467:INFO: Epoch: 4/5, Step: 1282/1406, Lr: 0.000000011-0.000011239-0.001123897, Loss: 4.214330, Time/step: 3.840988, DTime/step: 2.789573
2024-10-20 07:56:06,220:INFO: Epoch: 4/5, Step: 1332/1406, Lr: 0.000000011-0.000010543-0.001054297, Loss: 2.861573, Time/step: 3.515002, DTime/step: 2.326702
2024-10-20 07:59:11,447:INFO: Epoch: 4/5, Step: 1382/1406, Lr: 0.000000010-0.000009867-0.000986668, Loss: 2.827309, Time/step: 3.704523, DTime/step: 1.902413
2024-10-20 08:00:06,875:INFO: Epoch 4/5 Finished, Train Loss: 3.131888
2024-10-20 08:00:11,096:INFO: Model saved to ckpts/ckpt_msrvtt_AQ_4_Transf_4_12tokens_BiMaxThsMarginAll0.1_Beta0.2/pytorch_model.bin.3
2024-10-20 08:00:11,096:INFO: Optimizer saved to ckpts/ckpt_msrvtt_AQ_4_Transf_4_12tokens_BiMaxThsMarginAll0.1_Beta0.2/pytorch_opt.bin.3
2024-10-20 08:00:11,096:INFO: Eval on val dataset
2024-10-20 08:02:02,720:INFO: sim matrix size: 1000, 1000
2024-10-20 08:02:02,813:INFO: 	 Length-T: 1000, Length-V:1000
2024-10-20 08:02:02,813:INFO: Text-to-Video:
2024-10-20 08:02:02,813:INFO: 	>>>  R@1: 50.2 - R@5: 74.7 - R@10: 82.9 - Median R: 1.0 - Mean R: 13.8
2024-10-20 08:02:02,813:INFO: Video-to-Text:
2024-10-20 08:02:02,813:INFO: 	>>>  V2T$R@1: 49.0 - V2T$R@5: 75.0 - V2T$R@10: 84.2 - V2T$Median R: 2.0 - V2T$Mean R: 9.5
2024-10-20 08:02:02,815:INFO: The best model is: ckpts/ckpt_msrvtt_AQ_4_Transf_4_12tokens_BiMaxThsMarginAll0.1_Beta0.2/pytorch_model.bin.3, the R1 is: 50.2000
2024-10-20 08:03:35,653:INFO: Epoch: 5/5, Step: 26/1406, Lr: 0.000000009-0.000009210-0.000921042, Loss: 2.735215, Time/step: 1.853218, DTime/step: 0.904023
2024-10-20 08:06:31,480:INFO: Epoch: 5/5, Step: 76/1406, Lr: 0.000000009-0.000008575-0.000857452, Loss: 3.301569, Time/step: 3.516522, DTime/step: 1.794165
2024-10-20 08:09:22,810:INFO: Epoch: 5/5, Step: 126/1406, Lr: 0.000000008-0.000007959-0.000795930, Loss: 2.490218, Time/step: 3.426583, DTime/step: 1.890434
2024-10-20 08:12:10,389:INFO: Epoch: 5/5, Step: 176/1406, Lr: 0.000000007-0.000007365-0.000736507, Loss: 2.582397, Time/step: 3.351564, DTime/step: 1.875182
2024-10-20 08:15:15,725:INFO: Epoch: 5/5, Step: 226/1406, Lr: 0.000000007-0.000006792-0.000679213, Loss: 2.576474, Time/step: 3.706700, DTime/step: 2.862010
2024-10-20 08:18:05,206:INFO: Epoch: 5/5, Step: 276/1406, Lr: 0.000000006-0.000006241-0.000624076, Loss: 2.690246, Time/step: 3.389602, DTime/step: 2.813800
2024-10-20 08:21:01,836:INFO: Epoch: 5/5, Step: 326/1406, Lr: 0.000000006-0.000005711-0.000571123, Loss: 2.977629, Time/step: 3.532577, DTime/step: 2.364895
2024-10-20 08:23:52,985:INFO: Epoch: 5/5, Step: 376/1406, Lr: 0.000000005-0.000005204-0.000520382, Loss: 3.291002, Time/step: 3.422701, DTime/step: 1.792968
2024-10-20 08:26:53,816:INFO: Epoch: 5/5, Step: 426/1406, Lr: 0.000000005-0.000004719-0.000471877, Loss: 3.207819, Time/step: 3.616609, DTime/step: 1.800539
2024-10-20 08:30:05,909:INFO: Epoch: 5/5, Step: 476/1406, Lr: 0.000000004-0.000004256-0.000425633, Loss: 3.176076, Time/step: 3.841470, DTime/step: 1.798156
2024-10-20 08:33:05,355:INFO: Epoch: 5/5, Step: 526/1406, Lr: 0.000000004-0.000003817-0.000381672, Loss: 2.858414, Time/step: 3.588892, DTime/step: 1.844486
2024-10-20 08:35:58,723:INFO: Epoch: 5/5, Step: 576/1406, Lr: 0.000000003-0.000003400-0.000340017, Loss: 2.930416, Time/step: 3.467299, DTime/step: 1.894431
2024-10-20 08:38:51,491:INFO: Epoch: 5/5, Step: 626/1406, Lr: 0.000000003-0.000003007-0.000300688, Loss: 3.409311, Time/step: 3.455353, DTime/step: 1.893369
2024-10-20 08:42:00,746:INFO: Epoch: 5/5, Step: 676/1406, Lr: 0.000000003-0.000002637-0.000263706, Loss: 2.672310, Time/step: 3.785099, DTime/step: 1.913834
2024-10-20 08:44:59,051:INFO: Epoch: 5/5, Step: 726/1406, Lr: 0.000000002-0.000002291-0.000229088, Loss: 3.532033, Time/step: 3.566079, DTime/step: 2.575516
2024-10-20 08:48:02,281:INFO: Epoch: 5/5, Step: 776/1406, Lr: 0.000000002-0.000001969-0.000196852, Loss: 3.027333, Time/step: 3.664585, DTime/step: 3.279551
2024-10-20 08:50:59,452:INFO: Epoch: 5/5, Step: 826/1406, Lr: 0.000000002-0.000001670-0.000167014, Loss: 2.880322, Time/step: 3.543264, DTime/step: 3.144327
2024-10-20 08:54:04,012:INFO: Epoch: 5/5, Step: 876/1406, Lr: 0.000000001-0.000001396-0.000139589, Loss: 2.814303, Time/step: 3.691020, DTime/step: 3.311548
2024-10-20 08:57:01,845:INFO: Epoch: 5/5, Step: 926/1406, Lr: 0.000000001-0.000001146-0.000114590, Loss: 2.857366, Time/step: 3.556506, DTime/step: 3.152609
2024-10-20 09:00:03,859:INFO: Epoch: 5/5, Step: 976/1406, Lr: 0.000000001-0.000000920-0.000092030, Loss: 2.810239, Time/step: 3.640260, DTime/step: 3.012506
2024-10-20 09:03:06,255:INFO: Epoch: 5/5, Step: 1026/1406, Lr: 0.000000001-0.000000719-0.000071920, Loss: 2.826028, Time/step: 3.647909, DTime/step: 2.422680
2024-10-20 09:05:56,879:INFO: Epoch: 5/5, Step: 1076/1406, Lr: 0.000000001-0.000000543-0.000054271, Loss: 3.024053, Time/step: 3.412396, DTime/step: 2.933187
2024-10-20 09:09:04,308:INFO: Epoch: 5/5, Step: 1126/1406, Lr: 0.000000000-0.000000391-0.000039091, Loss: 3.307365, Time/step: 3.748565, DTime/step: 2.399363
2024-10-20 09:12:03,343:INFO: Epoch: 5/5, Step: 1176/1406, Lr: 0.000000000-0.000000264-0.000026388, Loss: 3.745918, Time/step: 3.580699, DTime/step: 1.882084
2024-10-20 09:14:55,784:INFO: Epoch: 5/5, Step: 1226/1406, Lr: 0.000000000-0.000000162-0.000016167, Loss: 3.648357, Time/step: 3.448774, DTime/step: 2.383233
2024-10-20 09:17:55,069:INFO: Epoch: 5/5, Step: 1276/1406, Lr: 0.000000000-0.000000084-0.000008435, Loss: 3.355137, Time/step: 3.585507, DTime/step: 3.190254
2024-10-20 09:20:53,595:INFO: Epoch: 5/5, Step: 1326/1406, Lr: 0.000000000-0.000000032-0.000003195, Loss: 3.084181, Time/step: 3.570511, DTime/step: 2.716780
2024-10-20 09:23:49,284:INFO: Epoch: 5/5, Step: 1376/1406, Lr: 0.000000000-0.000000004-0.000000449, Loss: 2.776942, Time/step: 3.513766, DTime/step: 2.173282
2024-10-20 09:25:15,151:INFO: Epoch 5/5 Finished, Train Loss: 2.939255
2024-10-20 09:25:19,106:INFO: Model saved to ckpts/ckpt_msrvtt_AQ_4_Transf_4_12tokens_BiMaxThsMarginAll0.1_Beta0.2/pytorch_model.bin.4
2024-10-20 09:25:19,107:INFO: Optimizer saved to ckpts/ckpt_msrvtt_AQ_4_Transf_4_12tokens_BiMaxThsMarginAll0.1_Beta0.2/pytorch_opt.bin.4
2024-10-20 09:25:19,107:INFO: Eval on val dataset
2024-10-20 09:26:13,807:INFO: sim matrix size: 1000, 1000
2024-10-20 09:26:13,900:INFO: 	 Length-T: 1000, Length-V:1000
2024-10-20 09:26:13,900:INFO: Text-to-Video:
2024-10-20 09:26:13,900:INFO: 	>>>  R@1: 49.7 - R@5: 74.5 - R@10: 83.7 - Median R: 2.0 - Mean R: 13.9
2024-10-20 09:26:13,900:INFO: Video-to-Text:
2024-10-20 09:26:13,900:INFO: 	>>>  V2T$R@1: 48.9 - V2T$R@5: 75.1 - V2T$R@10: 84.1 - V2T$Median R: 2.0 - V2T$Mean R: 9.6
2024-10-20 09:26:13,901:INFO: The best model is: ckpts/ckpt_msrvtt_AQ_4_Transf_4_12tokens_BiMaxThsMarginAll0.1_Beta0.2/pytorch_model.bin.3, the R1 is: 50.2000
